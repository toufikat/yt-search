!function(f){var g;"object"==typeof exports&&"undefined"!=typeof module?module.exports=f():"function"==typeof define&&define.amd?define([],f):(g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.ytSearch=f())}(function(){return function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(require,module,exports){"use strict";function _typeof(obj){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_typeof(obj)}var _cheerio=require("cheerio"),_dasu=require("dasu");require("async.parallellimit");_dasu.follow=!1,_dasu.debug=!1;var _require=require("./util.js"),_getScripts=_require._getScripts,_findLine=_require._findLine,_between=_require._between,_jp=require("jsonpath"),DEFAULT_USER_AGENT="Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html) (yt-search; https://www.npmjs.com/package/yt-search)",_userAgent=DEFAULT_USER_AGENT,_url=require("url"),_envs={};Object.keys(process.env).forEach(function(key){var n=process.env[key];if("0"==n||"false"==n||!n)return _envs[key]=!1;_envs[key]=n});var _debugging=_envs.debug;function debug(){_debugging&&console.log.apply(this,arguments)}var _querystring=require("querystring"),_humanTime=require("human-time"),TEMPLATES={YT:"https://youtube.com",SEARCH_MOBILE:"https://m.youtube.com/results",SEARCH_DESKTOP:"https://www.youtube.com/results"};function search(query,callback){if(!callback)return new Promise(function(resolve,reject){search(query,function(err,data){return err?reject(err):void resolve(data)})});var _options="string"==typeof query?{query:query}:query;return _options.userAgent&&(_userAgent=_options.userAgent),_options.search=_options.query||_options.search,_options.original_search=_options.search,_options.videoId?getVideoMetaData(_options.videoId,callback):_options.listId?getPlaylistMetaData(_options.listId,callback):_options.search?void work():callback(Error("yt-search: no query given"));function work(){getSearchResults(_options,callback)}}function _videoFilter(video,index,videos){if("video"!==video.type)return!1;var videoId=video.videoId,firstIndex=videos.findIndex(function(el){return videoId===el.videoId});return firstIndex===index}function _playlistFilter(result,index,results){if("list"!==result.type)return!1;var id=result.listId,firstIndex=results.findIndex(function(el){return id===el.listId});return firstIndex===index}function _channelFilter(result,index,results){if("channel"!==result.type)return!1;var url=result.url,firstIndex=results.findIndex(function(el){return url===el.url});return firstIndex===index}function _liveFilter(result,index,results){if("live"!==result.type)return!1;var videoId=result.videoId,firstIndex=results.findIndex(function(el){return videoId===el.videoId});return firstIndex===index}function _allFilter(result,index,results){switch(result.type){case"video":case"list":case"channel":case"live":break;default:return!1}var url=result.url,firstIndex=results.findIndex(function(el){return url===el.url});return firstIndex===index}function getSearchResults(_options,callback){var q=_querystring.escape(_options.search).split(/\s+/),hl=_options.hl||"en",gl=_options.gl||"US",category=_options.category||"",pageStart=Number(_options.pageStart)||1,pageEnd=Number(_options.pageEnd)||Number(_options.pages)||1;pageStart<=0&&(pageStart=1,1<=pageEnd&&(pageEnd+=1)),Number.isNaN(pageEnd)&&callback("error: pageEnd must be a number"),_options.pageStart=pageStart,_options.pageEnd=pageEnd,_options.currentPage=_options.currentPage||pageStart;var queryString="?";queryString+="search_query="+q.join("+"),-1===queryString.indexOf("&hl=")&&(queryString+="&hl="+hl),-1===queryString.indexOf("&gl=")&&(queryString+="&gl="+gl),category&&(queryString+="&category="+category),_options.sp&&(queryString+="&sp="+_options.sp);var uri=TEMPLATES.SEARCH_DESKTOP+queryString,params=_url.parse(uri);params.headers={"user-agent":_userAgent,accept:"text/html","accept-encoding":"gzip","accept-language":"en-US"},debug(params),debug("getting results: "+_options.currentPage),_dasu.req(params,function(err,res,body){if(err)callback(err);else{if(200!==res.status)return callback("http status: "+res.status);var fs;_debugging&&(fs=require("fs"),require("path"),fs.writeFileSync("dasu.response",res.responseText,"utf8"));try{_parseSearchResultInitialData(body,function(err,results){if(err)return callback(err);var list=results,videos=list.filter(_videoFilter),playlists=list.filter(_playlistFilter),channels=list.filter(_channelFilter),live=list.filter(_liveFilter),all=list.filter(_allFilter);_options._data=_options._data||{},_options._data.videos=_options._data.videos||[],_options._data.playlists=_options._data.playlists||[],_options._data.channels=_options._data.channels||[],_options._data.live=_options._data.live||[],_options._data.all=_options._data.all||[],videos.forEach(function(item){_options._data.videos.push(item)}),playlists.forEach(function(item){_options._data.playlists.push(item)}),channels.forEach(function(item){_options._data.channels.push(item)}),live.forEach(function(item){_options._data.live.push(item)}),all.forEach(function(item){_options._data.all.push(item)}),_options.currentPage++;var _videos,_playlists,_channels,_live,_all,getMoreResults=_options.currentPage<=_options.pageEnd;getMoreResults&&results._sp?(_options.sp=results._sp,setTimeout(function(){getSearchResults(_options,callback)},2500)):(_videos=_options._data.videos.filter(_videoFilter),_playlists=_options._data.playlists.filter(_playlistFilter),_channels=_options._data.channels.filter(_channelFilter),_live=_options._data.live.filter(_liveFilter),_all=_options._data.all.slice(_allFilter),callback(null,{all:_all,videos:_videos,live:_live,playlists:_playlists,lists:_playlists,accounts:_channels,channels:_channels}))})}catch(err){callback(err)}}})}function _parseSearchResultInitialData(responseText,callback){var re=/{.*}/,$=_cheerio.load(responseText),initialData=$("div#initial-data").html()||"",initialData=re.exec(initialData)||"";if(!initialData)for(var scripts=$("script"),i=0;i<scripts.length;i++){var script=$(scripts[i]).html(),lines=script.split("\n");lines.forEach(function(line){for(var i;0<=(i=line.indexOf("ytInitialData"));){line=line.slice(i+"ytInitialData".length);var match=re.exec(line);match&&match.length>initialData.length&&(initialData=match)}})}if(!initialData)return callback("could not find inital data in the html document");var errors=[],results=[],json=JSON.parse(initialData[0]),items=_jp.query(json,"$..itemSectionRenderer..contents.*");debug("items.length: "+items.length);for(var _i=0;_i<items.length;_i++){var item=items[_i],result=void 0,type="unknown",hasList=item.compactPlaylistRenderer||item.playlistRenderer,hasChannel=item.compactChannelRenderer||item.channelRenderer,hasVideo=item.compactVideoRenderer||item.videoRenderer,listId=hasList&&_jp.value(item,"$..playlistId"),channelId=hasChannel&&_jp.value(item,"$..channelId"),videoId=hasVideo&&_jp.value(item,"$..videoId"),watchingLabel=_jp.query(item,"$..viewCountText..text").join(""),isUpcoming="UPCOMING"===_jp.query(item,"$..thumbnailOverlayTimeStatusRenderer..style").join("").trim(),isLive=0<=watchingLabel.indexOf("watching")||"LIVE"===_jp.query(item,"$..thumbnailOverlayTimeStatusRenderer..text").join("").trim()||isUpcoming;videoId&&(type="video"),channelId&&(type="channel"),listId&&(type="list"),isLive&&(type="live");try{switch(type){case"video":var thumbnail=_normalizeThumbnail(_jp.value(item,"$..thumbnail..url"))||_normalizeThumbnail(_jp.value(item,"$..thumbnails..url"))||_normalizeThumbnail(_jp.value(item,"$..thumbnails")),title=_jp.value(item,"$..title..text")||_jp.value(item,"$..title..simpleText"),author_name=_jp.value(item,"$..shortBylineText..text")||_jp.value(item,"$..longBylineText..text"),author_url=_jp.value(item,"$..shortBylineText..url")||_jp.value(item,"$..longBylineText..url"),agoText=_jp.value(item,"$..publishedTimeText..text")||_jp.value(item,"$..publishedTimeText..simpleText"),viewCountText=_jp.value(item,"$..viewCountText..text")||_jp.value(item,"$..viewCountText..simpleText")||"0",viewsCount=Number(viewCountText.split(/\s+/)[0].split(/[,.]/).join("").trim()),lengthText=_jp.value(item,"$..lengthText..text")||_jp.value(item,"$..lengthText..simpleText"),duration=_parseDuration(lengthText||"0:00"),description=_jp.query(item,"$..description..text").join("")||_jp.query(item,"$..descriptionSnippet..text").join(""),url=TEMPLATES.YT+"/watch?v="+videoId,result={type:"video",videoId:videoId,url:url,title:title.trim(),description:description,image:thumbnail,thumbnail:thumbnail,seconds:Number(duration.seconds),timestamp:duration.timestamp,duration:duration,ago:agoText,views:Number(viewsCount),author:{name:author_name,url:TEMPLATES.YT+author_url}};break;case"list":var _thumbnail=_normalizeThumbnail(_jp.value(item,"$..thumbnail..url"))||_normalizeThumbnail(_jp.value(item,"$..thumbnails..url"))||_normalizeThumbnail(_jp.value(item,"$..thumbnails")),_title=_jp.value(item,"$..title..text")||_jp.value(item,"$..title..simpleText"),_author_name=_jp.value(item,"$..shortBylineText..text")||_jp.value(item,"$..longBylineText..text")||_jp.value(item,"$..shortBylineText..simpleText")||_jp.value(item,"$..longBylineText..simpleTextn")||"YouTube",_author_url=_jp.value(item,"$..shortBylineText..url")||_jp.value(item,"$..longBylineText..url")||"",video_count=_jp.value(item,"$..videoCountShortText..text")||_jp.value(item,"$..videoCountText..text")||_jp.value(item,"$..videoCountShortText..simpleText")||_jp.value(item,"$..videoCountText..simpleText")||_jp.value(item,"$..thumbnailText..text")||_jp.value(item,"$..thumbnailText..simpleText"),_url2=TEMPLATES.YT+"/playlist?list="+listId;result={type:"list",listId:listId,url:_url2,title:_title.trim(),image:_thumbnail,thumbnail:_thumbnail,videoCount:video_count,author:{name:_author_name,url:TEMPLATES.YT+_author_url}};break;case"channel":var _thumbnail2=_normalizeThumbnail(_jp.value(item,"$..thumbnail..url"))||_normalizeThumbnail(_jp.value(item,"$..thumbnails..url"))||_normalizeThumbnail(_jp.value(item,"$..thumbnails")),_title2=_jp.value(item,"$..title..text")||_jp.value(item,"$..title..simpleText")||_jp.value(item,"$..displayName..text"),_author_name2=_jp.value(item,"$..shortBylineText..text")||_jp.value(item,"$..longBylineText..text")||_jp.value(item,"$..displayName..text")||_jp.value(item,"$..displayName..simpleText"),video_count_label=_jp.value(item,"$..videoCountText..text")||_jp.value(item,"$..videoCountText..simpleText")||"0",sub_count_label=_jp.value(item,"$..subscriberCountText..text")||_jp.value(item,"$..subscriberCountText..simpleText");"string"==typeof sub_count_label&&(sub_count_label=sub_count_label.split(/\s+/).filter(function(w){return w.match(/\d/)})[0]);var _url3=_jp.value(item,"$..navigationEndpoint..url")||"/user/"+_title2;result={type:"channel",name:_author_name2,url:TEMPLATES.YT+_url3,title:_title2.trim(),image:_thumbnail2,thumbnail:_thumbnail2,videoCount:Number(video_count_label.replace(/\D+/g,"")),videoCountLabel:video_count_label,subCount:_parseSubCountLabel(sub_count_label),subCountLabel:sub_count_label};break;case"live":var _thumbnail3=_normalizeThumbnail(_jp.value(item,"$..thumbnail..url"))||_normalizeThumbnail(_jp.value(item,"$..thumbnails..url"))||_normalizeThumbnail(_jp.value(item,"$..thumbnails")),_title3=_jp.value(item,"$..title..text")||_jp.value(item,"$..title..simpleText"),_author_name3=_jp.value(item,"$..shortBylineText..text")||_jp.value(item,"$..longBylineText..text"),_author_url2=_jp.value(item,"$..shortBylineText..url")||_jp.value(item,"$..longBylineText..url"),_watchingLabel=_jp.query(item,"$..viewCountText..text").join("")||_jp.query(item,"$..viewCountText..simpleText").join("")||"0",watchCount=Number(_watchingLabel.split(/\s+/)[0].split(/[,.]/).join("").trim()),_description=_jp.query(item,"$..description..text").join("")||_jp.query(item,"$..descriptionSnippet..text").join(""),scheduledEpochTime=_jp.value(item,"$..upcomingEventData..startTime"),scheduledTime=Date.now()>scheduledEpochTime?1e3*scheduledEpochTime:scheduledEpochTime,scheduledDateString=_toInternalDateString(scheduledTime),_url4=TEMPLATES.YT+"/watch?v="+videoId;result={type:"live",videoId:videoId,url:_url4,title:_title3.trim(),description:_description,image:_thumbnail3,thumbnail:_thumbnail3,watching:Number(watchCount),author:{name:_author_name3,url:TEMPLATES.YT+_author_url2}},scheduledTime?(result.startTime=scheduledTime,result.startDate=scheduledDateString,result.status="UPCOMING"):result.status="LIVE"}result&&results.push(result)}catch(err){debug(err),errors.push(err)}}var ctoken=_jp.value(json,"$..continuation");return results._ctoken=ctoken,errors.length?callback(errors.pop(),results):callback(null,results)}function getVideoMetaData(opts,callback){var videoId;debug("fn: getVideoMetaData"),"string"==typeof opts&&(videoId=opts),"object"===_typeof(opts)&&(videoId=opts.videoId);var uri="https://www.youtube.com/watch?hl=en&gl=US&v="+videoId,params=_url.parse(uri);params.headers={"user-agent":_userAgent,accept:"text/html","accept-encoding":"gzip","accept-language":"en-US"},params.headers["user-agent"]="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1.1 Safari/605.1.15",_dasu.req(params,function(err,res,body){if(err)callback(err);else{if(200!==res.status)return callback("http status: "+res.status);var fs;_debugging&&(fs=require("fs"),require("path"),fs.writeFileSync("dasu.response",res.responseText,"utf8"));try{_parseVideoInitialData(body,callback)}catch(err){callback(err)}}})}function _parseVideoInitialData(responseText,callback){debug("_parseVideoInitialData"),responseText=_getScripts(responseText);var initialData=_between(_findLine(/ytInitialData.*=\s*{/,responseText),"{","}");if(!initialData)return callback("could not find inital data in the html document");var initialPlayerData=_between(_findLine(/ytInitialPlayerResponse.*=\s*{/,responseText),"{","}");if(!initialPlayerData)return callback("could not find inital player data in the html document");var idata=JSON.parse(initialData),ipdata=JSON.parse(initialPlayerData),videoId=_jp.value(idata,"$..currentVideoEndpoint..videoId");if(!videoId)return callback("video unavailable");if("ERROR"===_jp.value(ipdata,"$..status")||"Video unavailable"===_jp.value(ipdata,"$..reason"))return callback("video unavailable");var title=_jp.value(idata,"$..videoPrimaryInfoRenderer..title..text")||_jp.value(idata,"$..videoPrimaryInfoRenderer..title..simpleText")||_jp.value(idata,"$..videoPrimaryRenderer..title..text")||_jp.value(idata,"$..videoPrimaryRenderer..title..simpleText")||_jp.value(idata,"$..title..text")||_jp.value(idata,"$..title..simpleText"),description=_jp.query(idata,"$..description..text").join("")||_jp.query(ipdata,"$..description..simpleText").join("")||_jp.query(ipdata,"$..microformat..description..simpleText").join("")||_jp.query(ipdata,"$..videoDetails..shortDescription").join(""),author_name=_jp.value(idata,"$..owner..title..text")||_jp.value(idata,"$..owner..title..simpleText"),author_url=_jp.value(idata,"$..owner..navigationEndpoint..url")||_jp.value(idata,"$..owner..title..url"),thumbnailUrl="https://i.ytimg.com/vi/"+videoId+"/hqdefault.jpg",seconds=Number(_jp.value(ipdata,"$..videoDetails..lengthSeconds")),timestamp=_msToTimestamp(1e3*seconds),duration=_parseDuration(timestamp),sentimentBar=_jp.value(idata,"$..sentimentBar..tooltip").split(/[,.]/).join("").split(/\D+/),uploadDate=(Number(sentimentBar[0]),Number(sentimentBar[1]),_jp.value(idata,"$..uploadDate")||_jp.value(idata,"$..dateText..simpleText")),agoText=uploadDate&&_humanTime(new Date(uploadDate))||"",video={title:title,description:description,url:TEMPLATES.YT+"/watch?v="+videoId,videoId:videoId,seconds:Number(duration.seconds),timestamp:duration.timestamp,duration:duration,views:Number(_jp.value(ipdata,"$..videoDetails..viewCount")),genre:(_jp.value(ipdata,"$..category")||"").toLowerCase(),uploadDate:_toInternalDateString(uploadDate),ago:agoText,image:thumbnailUrl,thumbnail:thumbnailUrl,author:{name:author_name,url:TEMPLATES.YT+author_url}};callback(null,video)}function getPlaylistMetaData(opts,callback){var listId;debug("fn: getPlaylistMetaData"),"string"==typeof opts&&(listId=opts),"object"===_typeof(opts)&&(listId=opts.listId||opts.playlistId);var uri="https://www.youtube.com/playlist?hl=en&gl=US&list="+listId,params=_url.parse(uri);params.headers={"user-agent":_userAgent,accept:"text/html","accept-encoding":"gzip","accept-language":"en-US"},_dasu.req(params,function(err,res,body){if(err)callback(err);else{if(200!==res.status)return callback("http status: "+res.status);var fs;_debugging&&(fs=require("fs"),require("path"),fs.writeFileSync("dasu.response",res.responseText,"utf8"));try{_parsePlaylistInitialData(body,callback)}catch(err){callback(err)}}})}function _parsePlaylistInitialData(responseText,callback){debug("fn: parsePlaylistBody"),responseText=_getScripts(responseText);var jsonString=responseText.match(/ytInitialData.*=\s*({.*});/)[1];if(!jsonString)throw new Error("failed to parse ytInitialData json data");var json=JSON.parse(jsonString),listId=_jp.value(json,"$..microformat..urlCanonical").split("=")[1],viewCount=_jp.value(json,"$..sidebar.playlistSidebarRenderer.items[0]..stats[1].simpleText").match(/\d+/),list=_jp.query(json,"$..playlistVideoListRenderer..contents")[0],videos=[];list.forEach(function(playlistVideoRenderer){var json=playlistVideoRenderer,duration=_parseDuration(_jp.value(json,"$..lengthText..simpleText")||_jp.value(json,"$..thumbnailOverlayTimeStatusRenderer..simpleText")||_jp.query(json,"$..lengthText..text").join("")||_jp.query(json,"$..thumbnailOverlayTimeStatusRenderer..text").join("")),video={title:_jp.value(json,"$..title..simpleText")||_jp.value(json,"$..title..text")||_jp.query(json,"$..title..text").join(""),videoId:_jp.value(json,"$..videoId"),listId:listId,thumbnail:_jp.value(json,"$..thumbnail..thumbnails[0]..url").split("?")[0],duration:duration,author:{name:_jp.value(json,"$..shortBylineText..runs[0]..text"),url:"https://youtube.com"+_jp.value(json,"$..shortBylineText..runs[0]..url")}};videos.push(video)});var playlist={title:_jp.value(json,"$..microformat..title"),listId:listId,url:"https://youtube.com/playlist?list="+listId,views:Number(viewCount),date:_parsePlaylistLastUpdateTime(_jp.value(json,"$..sidebar.playlistSidebarRenderer.items[0]..stats[2]..simpleText")||_jp.query(json,"$..sidebar.playlistSidebarRenderer.items[0]..stats[2]..text").join("")||""),image:videos[0].thumbnail,thumbnail:videos[0].thumbnail,videos:videos,author:{name:_jp.value(json,"$..videoOwner..title..runs[0]..text"),url:"https://youtube.com"+_jp.value(json,"$..videoOwner..navigationEndpoint..url")}};callback&&callback(null,playlist)}function _parsePlaylistLastUpdateTime(lastUpdateLabel){debug("fn: _parsePlaylistLastUpdateTime");for(var words=lastUpdateLabel.trim().split(/[\s.-]+/),i=0;i<words.length;i++){var slice=words.slice(i),t=slice.join(" "),r=slice.reverse().join(" "),_a=new Date(t),b=new Date(r);if("Invalid Date"!==_a.toString())return _toInternalDateString(_a);if("Invalid Date"!==b.toString())return _toInternalDateString(b)}return""}function _toInternalDateString(date){return date=new Date(date),debug("fn: _toInternalDateString"),date.getFullYear()+"-"+(date.getMonth()+1)+"-"+date.getDate()}function _parseDuration(timestampText){var a=timestampText.split(/\s+/),lastword=a[a.length-1],timestamp=lastword.replace(/[^:.\d]/g,"");if(!timestamp)return{toString:function(){return a[0]},seconds:0,timestamp:0};for(;timestamp[timestamp.length-1].match(/\D/);)timestamp=timestamp.slice(0,-1);timestamp=timestamp.replace(/\./g,":");for(var t=timestamp.split(/[:.]/),seconds=0,exp=0,i=t.length-1;0<=i;i--)if(!(t[i].length<=0)){var number=t[i].replace(/\D/g,"");if(seconds+=parseInt(number)*(0<exp?Math.pow(60,exp):1),exp++,2<exp)break}return{toString:function(){return seconds+" seconds ("+timestamp+")"},seconds:seconds,timestamp:timestamp}}function _parseSubCountLabel(subCountLabel){if(subCountLabel){var label=subCountLabel.split(/\s+/).filter(function(w){return w.match(/\d/)})[0].toLowerCase(),m=label.match(/\d+(\.\d+)?/);if(m&&m[0]){var num=Number(m[0]),THOUSAND=1e3,MILLION=THOUSAND*THOUSAND;return 0<=label.indexOf("m")?MILLION*num:0<=label.indexOf("k")?THOUSAND*num:num}}}function _normalizeThumbnail(thumbnails){var t;return"string"!=typeof thumbnails?thumbnails.length?(t=thumbnails[0],_normalizeThumbnail(t)):void 0:(t=thumbnails,t=t.split("?")[0],t=t.split("/default.jpg").join("/hqdefault.jpg"),t=t.split("/default.jpeg").join("/hqdefault.jpeg"),0===t.indexOf("//")?"https://"+t.slice(2):t.split("http://").join("https://"))}function _msToTimestamp(ms){var t="",MS_HOUR=36e5,MS_MINUTE=6e4,MS_SECOND=1e3,h=Math.floor(ms/MS_HOUR),m=Math.floor(ms/MS_MINUTE)%60,s=Math.floor(ms/MS_SECOND)%60;return h&&(t+=h+":"),m&&(t+=m+":"),String(s).length<2&&(t+="0"),t+=s,t}function test(query){console.log("test: doing list search");var opts={query:query,pageEnd:1};search(opts,function(error,r){if(error)throw error;var videos=r.videos,playlists=r.playlists,channels=r.channels;console.log("videos: "+videos.length),console.log("playlists: "+playlists.length),console.log("channels: "+channels.length);for(var i=0;i<videos.length;i++){var song=videos[i],time=" (".concat(song.timestamp,")");console.log(song.title+time)}playlists.forEach(function(p){console.log("playlist: ".concat(p.title," | ").concat(p.listId))}),channels.forEach(function(c){console.log("channel: ".concat(c.title," | ").concat(c.description))})})}module.exports=function(query,callback){return search(query,callback)},module.exports.search=search,require.main===module&&test("superman theme list pewdiepie channel")},{"./util.js":2,"async.parallellimit":void 0,cheerio:void 0,dasu:void 0,fs:void 0,"human-time":void 0,jsonpath:void 0,path:void 0,querystring:void 0,url:void 0}],2:[function(require,module,exports){"use strict";var _cheerio=require("cheerio"),util={};function _getScripts(text){for(var $=_cheerio.load(text),scripts=$("script"),buffer="",i=0;i<scripts.length;i++){var el=scripts[i],child=el&&el.children[0],data=child&&child.data;data&&(buffer+=data+"\n")}return buffer}function _findLine(regex,text){var cache=_findLine.cache||{};_findLine.cache=cache,cache[text]=cache[text]||{};var lines=cache[text].lines||text.split("\n");cache[text].lines=lines,clearTimeout(cache[text].timeout),cache[text].timeout=setTimeout(function(){delete cache[text]},100);for(var i=0;i<lines.length;i++){var line=lines[i];if(regex.test(line))return line}return""}function _between(text,start,end){var i=text.indexOf(start),j=text.lastIndexOf(end);return i<0||j<0?"":text.slice(i,j+1)}module.exports=util,util._getScripts=_getScripts,util._findLine=_findLine,util._between=_between},{cheerio:void 0}]},{},[1])(1)});